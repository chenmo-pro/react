## 2.生命周期

[组件的生命周期](https://zh-hans.reactjs.org/docs/react-component.html#the-component-lifecycle)

[生命周期图谱](https://projects.wojtekmaj.pl/react-lifecycle-methods-diagram/)

按照图谱进行理解，画的很清楚。

### 2.1 class组件与function组件

function组件  

无生命周期和状态，仅展示信息，返回渲染结果

接收props信息

```js
import React from "react"
function clock(props){
  return(
  )
}
```

class组件

有状态和生命周期，继承component，实现render方法，无需频繁调用组件实现定时功能

组件可以在不同阶段执行不同业务逻辑

```js
import React from "react"
class clock extends React.Component{
   constructor(props){
       super(props);
       this.state = {date:new Date()}
   }
   componentDidMount(){}
   componentWillUnmount(){}
   render(){
       return(<div></div>)
   }
}
```

### 2.2 class组件实现定时器功能

ReactDOM.render调用Clock组件

Clock组件的render方法返回渲染结果

{调用this.state属性

state初始化

挂载 设置定时器 调用tick方法设置状态

卸载}

返回渲染结果

```js
//声明class组件 state
//渲染Clock---找到构造函数constructor 初始化state---调用生命周期挂载---调用tick---调用生命周期卸载
class Clock extends React.Component {
  constructor(props) {
    super(props);
    this.state = {date: new Date()};
  }

  componentDidMount() {
    this.timerID = setInterval(
      () => this.tick(),
      1000
    );
  }

  componentWillUnmount() {
    clearInterval(this.timerID);
  }

  tick() {
    this.setState({
      date: new Date()
    });
  }

  render() {
    return (
      <div>
        <h1>Hello, world!</h1>
        <h2>It is {this.state.date.toLocaleTimeString()}.</h2>
      </div>
    );
  }
}

ReactDOM.render(
  <Clock />,
  document.getElementById('root')
);
```

### 2.3要求：

#### 2.3.1区分didmount和didupdate

```
组件开始调用

组件开始挂载 没有参数，挂载时只执行一次
componengtWillMounted  将要挂载触发的函数
componengtDudMounted   挂载完成触发的函数

组件开始更新参数   更新参数时都会执行
componentWillUpdate   将要更新数据触发的函数
传递新属性newprops以及新状态newstate  
componengtDidUpdate   更新完成触发的函数
完成更新
```

#### 2.3.2卸载时候触发的生命周期

componentWillUnmount

#### 2.3.3各个生命周期函数和render相比，执行的先后顺序

![](C:\Users\unicom\Desktop\2.生命周期.assets\20210114161233.jpg)

render在props.state改变时触发



#### 2.3.4结合公司项目代码思考，各个生命周期的使用场景

![2](https://gitee.com/chenmo97/react/raw/master/img/20210114165150.png)

初始化  init props state

挂载  componentWillMount

render

componentDidMount

更新 props state

WillUpdate

render

DidUpdate

卸载

componentWillUnmount

### 2.4 生命周期图谱的理解

![1](https://gitee.com/chenmo97/react/raw/master/img/20210114161152.png)

